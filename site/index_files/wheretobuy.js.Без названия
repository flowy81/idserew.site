var $j=jQuery.noConflict();function getQuerystring(key,default_){if(default_==null)default_="";key=key.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regex=new RegExp("[\\?&]"+key+"=([^&#]*)");var qs=regex.exec(window.location.href);if(qs==null)
return default_;else
return qs[1];}
var WhereToBuy={hasValidUserInput:function(countryCtrl,entryCtrl,fuelTypesCtrl,searchTypeCtrl){var hasValidInput=true;var isInternational=false;var errorMessages="";if(countryCtrl!=""){var country=$j("#"+countryCtrl).val();if(country!="US"&&country!="CA"&&country!="USCA"){isInternational=true;return true;}}
if(fuelTypesCtrl!=""){var numberOfFuelTypes=$j('#'+fuelTypesCtrl+" input:checked").length;if(numberOfFuelTypes==0){errorMessages="Fuel type selection is required. ";}}
if(!isInternational){var userInput=$j('#'+entryCtrl).val();$j.ajax({url:"../../services/LocatorService.asmx/ValidateUserInput",type:"POST",async:false,cache:false,timeout:30000,contentType:"application/json; charset=utf-8",data:"{userInput:'"+userInput+"'}",error:function(){return true;},success:function(response){if(!response.d){errorMessages=errorMessages+"A valid postal code or city and state/province abbreviation is required."
hasValidInput=false;}}});}
if(errorMessages!=""){errorMessages="Please check your selections and try again. "+errorMessages;alert(errorMessages);return false;}
else{return true;}},selectDealer:function(dealerid){var promoIDs=$j('#dealer_promo_'+dealerid).text().split(',');var brands=$j('#dealer_brands_'+dealerid).text().split(',');$j('#system_promotions  li').hide();for(var i=0;i<promoIDs.length;i++){$j('#system_promotion_'+promoIDs[i]).show();}},showDebugMode:function(){$j('#locator_search_log').show();$j('.hidden_dealer_debug_properties').show();},countryChanged:function(countryInputCtrlID,entryContainerCtrlID,fuelTypesContainerCtrlID,searchTypeContainerCtrlID,sortTypeCtrlID){var isInternational=false;if(countryInputCtrlID!=""){var country=$j("#"+countryInputCtrlID).val();if(country!="US"&&country!="CA"&&country!="USCA"){isInternational=true;}}
if(isInternational){if(entryContainerCtrlID!=""){$j("#"+entryContainerCtrlID).hide();}
if(fuelTypesContainerCtrlID!=""){$j("#"+fuelTypesContainerCtrlID).hide();}
if(searchTypeContainerCtrlID!=""){$j("#"+searchTypeContainerCtrlID).hide();}
if(sortTypeCtrlID!=""){$j("#"+sortTypeCtrlID).hide();}}
else{if(entryContainerCtrlID!=""){$j("#"+entryContainerCtrlID).show();}
if(fuelTypesContainerCtrlID!=""){$j("#"+fuelTypesContainerCtrlID).show();}
if(searchTypeContainerCtrlID!=""){$j("#"+searchTypeContainerCtrlID).show();}
if(sortTypeCtrlID!=""){$j("#"+sortTypeCtrlID).show();}}},searchTypeChanged:function(searchTypeContainerCtrlID,sortInputCtrlID,consumerPanelCtrlID,professionalPanelCtrlID,proZipDiv,proCountyDiv,fuelTypeDiv){var isProfessional="";var selected=$j("#"+searchTypeContainerCtrlID+" input[type='radio']:checked");if(selected.length>0){isProfessional=selected.val()=="rdoSearchTypeProfessional";}
var message="";if(!isProfessional){message="Authorized Dealer Status Level";$j("#"+consumerPanelCtrlID).show();$j("#"+professionalPanelCtrlID).hide();$j("#"+sortInputCtrlID).show();$j("#"+fuelTypeDiv).show();}
else{message="Authorized Distributor Status Level";$j("#"+consumerPanelCtrlID).hide();$j("#"+professionalPanelCtrlID).show();$j("#"+fuelTypeDiv).hide();var selectedProType="";var selected=$j("#"+professionalPanelCtrlID+" input[type='radio']:checked");if(selected.length>0){selectedProType=selected.val();if(selectedProType=='rdoProByZip'){$j("#"+proZipDiv).show();$j("#"+proCountyDiv).hide();$j("#"+sortInputCtrlID).show();}
else if(selectedProType=='rdoProByCounty'){$j("#"+proZipDiv).hide();$j("#"+proCountyDiv).show();$j("#"+sortInputCtrlID).hide();}}}},prosearchTypeChanged:function(rdoCountyCtrl,rdoZipCtrl,zipDivCtrl,countyDivCtrl,sortInputCtrlID){var selectedVal="";var selected=$j("#divProSearchType input[type='radio']:checked");if(selected.length>0){selectedVal=selected.val();}
if(selectedVal=='rdoProByZip'){$j("#"+zipDivCtrl).show();$j("#"+countyDivCtrl).hide();$j("#"+sortInputCtrlID).show();}
else if(selectedVal=='rdoProByCounty'){$j("#"+zipDivCtrl).hide();$j("#"+countyDivCtrl).show();$j("#"+sortInputCtrlID).hide();}},executeSearch:function(btnCntrl,countryCtrl,entryCtrl,fuelTypesCtrl,searchTypeCtrl,sortCtrl){var hasValidInput=true;var isInternational=false;var errorMessages="";if(countryCtrl!=""){var country=$j("#"+countryCtrl).val();if(country!="US"&&country!="CA"&&country!="USCA"){isInternational=true;return true;}}
if(fuelTypesCtrl!=""){var numberOfFuelTypes=$j('#'+fuelTypesCtrl+" input:checked").length;if(numberOfFuelTypes==0){errorMessages="Fuel type selection is required. ";}}
if(sortCtrl!=""){var site=GetCurrentSite();var sort=$j("#"+sortCtrl).val();if(sort=="notselected"&&site!="fireside"){errorMessages=errorMessages+"Sort option is required. ";}}
if(!isInternational){var userInput=$j('#'+entryCtrl).val();$j.ajax({url:"../../services/LocatorService.asmx/ValidateUserInput",type:"POST",async:false,cache:false,timeout:30000,contentType:"application/json; charset=utf-8",data:"{userInput:'"+userInput+"'}",error:function(){return true;},success:function(response){if(!response.d){errorMessages=errorMessages+"A valid postal code or city and state/province abbreviation is required."
hasValidInput=false;}}});}
if(errorMessages!=""){errorMessages="Please check your selections and try again. "+errorMessages;alert(errorMessages);return false;}
if(hasValidInput){var btnSearch=$j("[id$='"+btnCntrl+"']").get(0);btnSearch.click();}
return hasValidInput;}}
MiniLocator={selectDealer:function(btn){var selectDealerBtn=$j("[id$='"+btn+"']").get(0);selectDealerBtn.click();$j("[id$='txtSelectedDealer']").val("1");},clearDealer:function(){$j("[id$='txtSelectedDealer']").val("");},hasValidUserInput:function(countryCtrl,entryCtrl,fuelTypesCtrl,searchTypeCtrl){var approved=WhereToBuy.hasValidUserInput(countryCtrl,entryCtrl,fuelTypesCtrl,searchTypeCtrl);if(approved){MiniLocator.clearDealer();}
return approved;}};function CreateMapInfoWindow(){window.MapPinInfoWindow=(function(){if(typeof(google)=="undefined"){alert('google undefined');return;}
var f=function(options){this.options=options;};f.prototype=Object.extend(google.maps.OverlayView.prototype,{open:function(map,marker){this.setMap(map);this.marker=marker;this.map=map;},close:function(){this.setMap(null);},onAdd:function(){this.div=new Element("div");this.div.addClassName="info_window";this.div.style.position="absolute";this.div.update(this.options.content);this.getPanes().floatPane.appendChild(this.div);},onRemove:function(){if(this.div.parentNode!=null){this.div.parentNode.removeChild(this.div)
this.div=null;}},draw:function(){var overlayProjection=this.getProjection();var sw=overlayProjection.fromLatLngToDivPixel(this.marker.getPosition());this.div.style.left=sw.x+20+'px';this.div.style.top=sw.y-82+'px';if(this.alreadyMoved==undefined){this.alreadyMoved=true;var newpoint=new google.maps.Point(sw.x+40,sw.y+100)
this.map.panTo(overlayProjection.fromDivPixelToLatLng(newpoint));}}});return f;})();}
ContactDealer={load:function(dealerID){var serviceMode=document.URL.toLowerCase().indexOf("service-locator.aspx")!=-1;HHTSitecore.services.LocatorService.LoadContactDealer(dealerID,serviceMode,this.onLoadSuccess.bind(this),null);},onLoadSuccess:function(result){$j('#contact_dealer').html(result);},validateProject:function(name,email,phone,starting){var error="";if(name==""){error="Please complete the Name field";}
else if(email==""){error="Please enter a valid email address";}
else if(!Validate.email(email)){error="Please enter a valid email address";}
else if(phone==""){error="Please complete the Phone field";}
else if(starting=="Not Specified"){error="Please complete the Project Starting field";}
else{error="";}
if(error!=""){$j('#send_project_error').text(error);return false;}
return true;},submitProject:function(){var dealerID=$j('#divDealerID').html();var projectID=$j('#divMyAccountProjectFolderID').html();var useServiceMode=false;var name=$j('#txtProjectName').val();var email=$j('#txtProjectEmail').val();var phone=$j('#txtProjectPhone').val();var msg=$j('#txtProjectMessage').val();var starting=$j("#ddlProjectStarting").children("option").filter(":selected").text();var projecttype=$j("#ddlProjectTypes").children("option").filter(":selected").text();var producttype=$j("#ddlProductTypes").children("option").filter(":selected").text();var fueltype=$j("#ddlFuelTypes").children("option").filter(":selected").text();var location=$j("#ddlProjectLocations").children("option").filter(":selected").text();var call=$j("#chkPhone").is(':checked');var newsletter=$j("#chkJoin").is(':checked');var isHbd=getQuerystring("hbd",false);if(this.validateProject(name,email,phone,starting)){HHTSitecore.services.LocatorService.SubmitProject(dealerID,projectID,name,email,phone,msg,starting,projecttype,producttype,fueltype,location,call,newsletter,useServiceMode,isHbd,this.onSubmitProjectSuccess.bind(this),null);}},onSubmitProjectSuccess:function(result){var success=result.status;var messageSection=result.messageSection;var message=result.message;if(success){$j('#divContactDealer').hide();$j('#divProjectSent').show();}
else{message="An error occurred. Please try again later.";$j('#send_project_error').text(message);}}};